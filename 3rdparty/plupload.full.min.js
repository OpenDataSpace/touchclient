/**
 * mOxie - multi-runtime File API & XMLHttpRequest L2 Polyfill
 * v1.0a
 *
 * Copyright 2012, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 *
 * Date: 2012-11-13
 */
;(function(e,t,n){function r(e){return typeof e!="string"?e:t.getElementById(e)}r.ua=function(){function i(e){var t,n;for(var i=0;i<e.length;i++){t=e[i].s1,n=e[i].prop,r=e[i].sv||e[i].id;if(t){if(t.indexOf(e[i].s2)!=-1)return e[i].id}else if(n)return e[i].id}}function s(e){var t=e.indexOf(r);if(t==-1)return;return parseFloat(e.substring(t+r.length+1))}var t=[{s1:navigator.userAgent,s2:"Chrome",id:"Chrome"},{s1:navigator.vendor,s2:"Apple",id:"Safari",sv:"Version"},{prop:e.opera&&e.opera.buildNumber,id:"Opera",sv:"Version"},{s1:navigator.vendor,s2:"KDE",id:"Konqueror"},{s1:navigator.userAgent,s2:"Firefox",id:"Firefox"},{s1:navigator.vendor,s2:"Camino",id:"Camino"},{s1:navigator.userAgent,s2:"Netscape",id:"Netscape"},{s1:navigator.userAgent,s2:"MSIE",id:"IE",sv:"MSIE"},{s1:navigator.userAgent,s2:"Gecko",id:"Mozilla",sv:"rv"}],n=[{s1:navigator.platform,s2:"Win",id:"Windows"},{s1:navigator.platform,s2:"Mac",id:"Mac"},{s1:navigator.userAgent,s2:"iPhone",id:"iOS"},{s1:navigator.userAgent,s2:"iPad",id:"iOS"},{s1:navigator.platform,s2:"Linux",id:"Linux"}],r;return{browser:i(t),version:s(navigator.userAgent)||s(navigator.appVersion),OS:i(n)}}(),r.ua.can=function(){var n={define_property:function(){try{var e={};if(Object.defineProperty)return Object.defineProperty(e,"prop",{enumerable:!0,configurable:!0}),!0}catch(t){}return Object.prototype.__defineGetter__&&Object.prototype.__defineSetter__?!0:!1}(),create_canvas:function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")}(),receive_response_type:function(t){if(!e.XMLHttpRequest)return!1;try{var n=new XMLHttpRequest;if(r.typeOf(n.responseType)!=="undefined")return n.open("get","infinity-8.me"),n.responseType=t,n.responseType!==t?!1:!0}catch(i){}return!1},use_data_uri:function(){var e=new Image;return e.onload=function(){n.use_data_uri=e.width===1&&e.height===1},setTimeout(function(){e.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return n.use_data_uri&&(r.ua.browser!=="IE"||r.ua.version>=9)},use_data_uri_of:function(e){return n.use_data_uri&&e<33e3||n.use_data_uri_over32kb()}};return function(e){var t=[].slice.call(arguments);return t.shift(),r.typeOf(n[e])==="function"?n[e].apply(this,t):!!n[e]}}(),e.mOxie=e.o=r})(window,document),function(e,t,n,r){n=n||{},n.typeOf=function(t){var n;return t===n?"undefined":t===null?"null":t.nodeType?"node":{}.toString.call(t).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},n.extend=function(e){return n.each(arguments,function(t,i){i>0&&n.each(t,function(t,i){t!==r&&(n.typeOf(e[i])!==n.typeOf(t)||!~n.inArray(n.typeOf(t),["array","object"])?e[i]=t:n.extend(e[i],t))})}),e},n.each=function(e,t){var n,i,s;if(e){try{n=e.length}catch(o){n=r}if(n===r){for(i in e)if(e.hasOwnProperty(i)&&t(e[i],i)===!1)return}else for(s=0;s<n;s++)if(t(e[s],s)===!1)return}},n.extend(n,{isEmptyObj:function(e){if(!e||n.typeOf(e)!=="object")return!0;for(var t in e)return!1;return!0},inSeries:function(e,t){function s(r){n.typeOf(e[r])==="function"&&e[r](function(e){++r<i&&!e?s(r):t(e)})}var r=0,i=e.length;n.typeOf(t)!=="function"&&(t=function(){}),(!e||!e.length)&&t(),s(r)},inArray:function(e,t){if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n}return-1},toArray:function(e){var t,n=[];for(t=0;t<e.length;t++)n[t]=e[t];return n},xmlEncode:function(e){var t={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},n=/[<>&\"\']/g;return e?(""+e).replace(n,function(e){return t[e]?"&"+t[e]+";":e}):e},inherit:function(e,t){var r,i=[].slice.call(arguments,2);e=n.typeOf(e)==="function"?new e:e;if(!t||n.typeOf(t)==="object"){var s=function(){};s.prototype=e,r=n.extend(new s,t)}else{if(n.typeOf(t)!=="function")return;t.prototype=e,r=new t}return n.typeOf(r.init)==="function"&&r.init.apply(r,i),r},guid:function(){var e=0;return function(t){var n=(new Date).getTime().toString(32),r;for(r=0;r<5;r++)n+=Math.floor(Math.random()*65535).toString(32);return(t||"o_")+n+(e++).toString(32)}}(),trim:function(e){return e?String.prototype.trim?String.prototype.trim.call(e):e.toString().replace(/^\s*/,"").replace(/\s*$/,""):e},hasClass:function(e,t){var n;return e.className==""?!1:(n=new RegExp("(^|\\s+)"+t+"(\\s+|$)"),n.test(e.className))},addClass:function(e,t){n.hasClass(e,t)||(e.className=e.className==""?t:e.className.replace(/\s+$/,"")+" "+t)},removeClass:function(e,t){var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e.className=e.className.replace(n,function(e,t,n){return t===" "&&n===" "?" ":""})},getStyle:function(t,n){if(t.currentStyle)return t.currentStyle[n];if(e.getComputedStyle)return e.getComputedStyle(t,null)[n]},getPos:function(e,n){function f(e){var t,n,r=0,i=0;return e&&(n=e.getBoundingClientRect(),t=o.compatMode==="CSS1Compat"?o.documentElement:o.body,r=n.left+t.scrollLeft,i=n.top+t.scrollTop),{x:r,y:i}}var r=0,i=0,s,o=t,u,a;e=e,n=n||o.body;if(e&&e.getBoundingClientRect&&navigator.userAgent.indexOf("MSIE")>0&&o.documentMode!==8)return u=f(e),a=f(n),{x:u.x-a.x,y:u.y-a.y};s=e;while(s&&s!=n&&s.nodeType)r+=s.offsetLeft||0,i+=s.offsetTop||0,s=s.offsetParent;s=e.parentNode;while(s&&s!=n&&s.nodeType)r-=s.scrollLeft||0,i-=s.scrollTop||0,s=s.parentNode;return{x:r,y:i}},getSize:function(e){return{w:e.offsetWidth||e.clientWidth,h:e.offsetHeight||e.clientHeight}},parseSizeStr:function(e){if(typeof e!="string")return e;var t={t:1099511627776,g:1073741824,m:1048576,k:1024},n;return e=/^([0-9]+)([mgk]?)$/.exec(e.toLowerCase().replace(/[^0-9mkg]/g,"")),n=e[2],e=+e[1],t.hasOwnProperty(n)&&(e*=t[n]),e}}),function(){var e="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe";n.extend(n,{mimes:{},extensions:{},addMimeType:function(e){var t=e.split(/,/),n,r,i;for(n=0;n<t.length;n+=2){i=t[n+1].split(/ /);for(r=0;r<i.length;r++)this.mimes[i[r]]=t[n];this.extensions[t[n]]=i}},extList2mimes:function(e){var t=this,r,i,s,u,a,f=[];e:for(i=0;i<e.length;i++){r=e[i].extensions.split(/\s*,\s*/);for(s=0;s<r.length;s++){if(r[s]==="*"){f=[];break e}a=t.mimes[r[s]],a&&!~n.inArray(a,f)&&f.push(a)}}return f},mimes2extList:function(e){var t=this,r="",i=[];return e=n.trim(e),e!=="*"?n.each(e.split(/\s*,\s*/),function(e,n){t.extensions[e]&&(r+=t.extensions[e].join(","))}):r=e,i.push({title:n.translate("Files"),extensions:r}),i.mimes=e,i}}),n.addMimeType(e)}(),function(){function s(){this.returnValue=!1}function u(){this.cancelBubble=!0}var t={},i;n.extend(n,{addEvent:function(a,f,l){var c,h,p,d;d=arguments[3],f=f.toLowerCase(),i===r&&(i="Moxie_"+n.guid()),a.addEventListener?(c=l,a.addEventListener(f,c,!1)):a.attachEvent&&(c=function(){var t=e.event;t.target||(t.target=t.srcElement),t.preventDefault=s,t.stopPropagation=u,l(t)},a.attachEvent("on"+f,c)),a[i]===r&&(a[i]=n.guid()),t.hasOwnProperty(a[i])||(t[a[i]]={}),h=t[a[i]],h.hasOwnProperty(f)||(h[f]=[]),h[f].push({func:c,orig:l,key:d})},removeEvent:function(e,s){var u,a,f;typeof arguments[2]=="function"?a=arguments[2]:f=arguments[2],s=s.toLowerCase();if(!(e[i]&&t[e[i]]&&t[e[i]][s]))return;u=t[e[i]][s];for(var l=u.length-1;l>=0;l--)if(u[l].key===f||u[l].orig===a){e.removeEventListener?e.removeEventListener(s,u[l].func,!1):e.detachEvent&&e.detachEvent("on"+s,u[l].func),u[l].orig=null,u[l].func=null,u.splice(l,1);if(a!==r)break}u.length||delete t[e[i]][s];if(n.isEmptyObj(t[e[i]])){delete t[e[i]];try{delete e[i]}catch(c){e[i]=r}}},removeAllEvents:function(e){var s=arguments[1];if(e[i]===r||!e[i])return;n.each(t[e[i]],function(t,r){n.removeEvent(e,r,s)})}})}(),function(){function e(e,t,r){n.typeOf(r)==="object"&&(i.call(e,t,r,"get"),Object.defineProperty||i.call(e,t,r,"set"))}function t(e,t,n){return i.call(e,t,n,"get")}function r(e,t,n){return i.call(e,t,n,"set")}function i(e,t,r){var i={enumerable:!0,configurable:!0},s,u,a=this;r=r.toLowerCase(),u=r.replace(/^[gs]/,function(e){return e.toUpperCase()});if(n.typeOf(t)==="function")s=t,t={},t[r]=s;else{if(n.typeOf(t[r])!=="function")return;s=t[r]}if(n.ua.can("define_property"))return Object.defineProperty?Object.defineProperty(this,e,n.extend({},i,t)):a["__define"+u+"ter__"](e,s)}n.defineGetter=t,n.defineSetter=r,n.defineProperty=e}(),n.extend(n,{parseUrl:function(e){var n=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],r=n.length,i={http:80,https:443},s={},o=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,u=o.exec(e||"");while(r--)u[r]&&(s[n[r]]=u[r]);if(/^[^\/]/.test(s.path)&&!s.scheme){var a=t.location.pathname;/(\/|\/[^\.]+)$/.test(a)||(a=a.replace(/[^\/]+$/,"")),s.host=t.location.hostname,s.path=a+(s.path||"")}return s.scheme||(s.scheme=t.location.protocol.replace(/:$/,"")),s.host||(s.host=t.location.hostname),s.port?s.port=parseInt(s.port,10):s.port=i[s.scheme],s.path||(s.path="/"),delete s.source,s},resolveUrl:function(e){var t={http:80,https:443},r=n.parseUrl(e);return r.scheme+"://"+r.host+(r.port!==t[r.scheme]?":"+r.port:"")+r.path+(r.query?r.query:"")},utf8_encode:function(e){return unescape(encodeURIComponent(e))},utf8_decode:function(e){return decodeURIComponent(escape(e))},atob:function(t){if(typeof e["atob"]=="function")return e.atob(t);var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,i,s,o,u,a,f,l,c=0,h=0,p="",d=[];if(!t)return t;t+="";do o=n.indexOf(t.charAt(c++)),u=n.indexOf(t.charAt(c++)),a=n.indexOf(t.charAt(c++)),f=n.indexOf(t.charAt(c++)),l=o<<18|u<<12|a<<6|f,r=l>>16&255,i=l>>8&255,s=l&255,a==64?d[h++]=String.fromCharCode(r):f==64?d[h++]=String.fromCharCode(r,i):d[h++]=String.fromCharCode(r,i,s);while(c<t.length);return p=d.join(""),p},btoa:function(t){if(typeof e["btoa"]=="function")return e.btoa(t);var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,i,s,o,u,a,f,l,c=0,h=0,p="",d=[];if(!t)return t;do r=t.charCodeAt(c++),i=t.charCodeAt(c++),s=t.charCodeAt(c++),l=r<<16|i<<8|s,o=l>>18&63,u=l>>12&63,a=l>>6&63,f=l&63,d[h++]=n.charAt(o)+n.charAt(u)+n.charAt(a)+n.charAt(f);while(c<t.length);p=d.join("");var v=t.length%3;return(v?p.slice(0,v-3):p)+"===".slice(v||3)}}),n.JSON={},n.JSON.parse=!!e.JSON&&JSON.parse||function(){"use strict";var e,t,n={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},i,s=function(t){throw{name:"SyntaxError",message:t,at:e,text:i}},o=function(n){return n&&n!==t&&s("Expected '"+n+"' instead of '"+t+"'"),t=i.charAt(e),e+=1,t},u=function(){var e,n="";t==="-"&&(n="-",o("-"));while(t>="0"&&t<="9")n+=t,o();if(t==="."){n+=".";while(o()&&t>="0"&&t<="9")n+=t}if(t==="e"||t==="E"){n+=t,o();if(t==="-"||t==="+")n+=t,o();while(t>="0"&&t<="9")n+=t,o()}e=+n;if(!!isFinite(e))return e;s("Bad number")},a=function(){var e,r,i="",u;if(t==='"')while(o()){if(t==='"')return o(),i;if(t==="\\"){o();if(t==="u"){u=0;for(r=0;r<4;r+=1){e=parseInt(o(),16);if(!isFinite(e))break;u=u*16+e}i+=String.fromCharCode(u)}else{if(typeof n[t]!="string")break;i+=n[t]}}else i+=t}s("Bad string")},f=function(){while(t&&t<=" ")o()},l=function(){switch(t){case"t":return o("t"),o("r"),o("u"),o("e"),!0;case"f":return o("f"),o("a"),o("l"),o("s"),o("e"),!1;case"n":return o("n"),o("u"),o("l"),o("l"),null}s("Unexpected '"+t+"'")},c,h=function(){var e=[];if(t==="["){o("["),f();if(t==="]")return o("]"),e;while(t){e.push(c()),f();if(t==="]")return o("]"),e;o(","),f()}}s("Bad array")},p=function(){var e,n={};if(t==="{"){o("{"),f();if(t==="}")return o("}"),n;while(t){e=a(),f(),o(":"),Object.hasOwnProperty.call(n,e)&&s('Duplicate key "'+e+'"'),n[e]=c(),f();if(t==="}")return o("}"),n;o(","),f()}}s("Bad object")};return c=function(){f();switch(t){case"{":return p();case"[":return h();case'"':return a();case"-":return u();default:return t>="0"&&t<="9"?u():l()}},function(n,o){var u;return i=n,e=0,t=" ",u=c(),f(),t&&s("Syntax error"),typeof o=="function"?function a(e,t){var n,i,s=e[t];if(s&&typeof s=="object")for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(i=a(s,n),i!==r?s[n]=i:delete s[n]);return o.call(e,t,s)}({"":u},""):u}}()}(window,document,mOxie),function(e,t,n,r){function i(e,t){var n;for(n in e)if(e[n]===t)return n;return null}n.Exceptions={RuntimeError:function(){function t(t){this.code=t,this.name=i(e,t),this.message=this.name+": RuntimeError "+this.code}var e={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return n.extend(t,e),t.prototype=Error.prototype,t}(),OperationNotAllowedException:function(){function e(e){this.code=e,this.name="OperationNotAllowedException"}return mOxie.extend(e,{NOT_ALLOWED_ERR:1}),e.prototype=Error.prototype,e}(),ImageError:function(){function t(t){this.code=t,this.name=i(e,t),this.message=this.name+": ImageError "+this.code}var e={WRONG_FORMAT:1};return n.extend(t,e),t.prototype=Error.prototype,t}(),FileException:function(){function t(t){this.code=t,this.name=i(e,t),this.message=this.name+": FileException "+this.code}var e={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return n.extend(t,e),t.prototype=Error.prototype,t}(),DOMException:function(){function t(t){this.code=t,this.name=i(e,t),this.message=this.name+": DOMException "+this.code}var e={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return n.extend(t,e),t.prototype=Error.prototype,t}(),EventException:function(){function e(e){this.code=e,this.name="EventException"}return n.extend(e,{UNSPECIFIED_EVENT_TYPE_ERR:0}),e.prototype=Error.prototype,e}()}}(window,document,mOxie),function(e,t,n,r){var i={};n.extend(n,{addI18n:function(e){return n.extend(i,e)},translate:function(e){return i[e]||e},_:function(e){return n.translate(e)}})}(window,document,mOxie),function(e,t,n,r){var i=n.Exceptions;n.eventTarget=new(function(){function e(){var e={};n.extend(this,{uid:null,init:function(){this.uid||(this.uid=n.guid("uid_"))},addEventListener:function(t,r,i,s){var u=this,a;t=n.trim(t);if(/\s/.test(t)){n.each(t.split(/\s+/),function(e,t){u.addEventListener(e,r,i,s)});return}t=t.toLowerCase(),i=parseInt(i,10)||0,a=e[this.uid]&&e[this.uid][t]||[],a.push({fn:r,priority:i,scope:s||this}),e[this.uid]||(e[this.uid]={}),e[this.uid][t]=a},hasEventListener:function(t){return t?!!e[this.uid]&&!!e[this.uid][t]:!!e[this.uid]},removeEventListener:function(t,r){t=t.toLowerCase();var i=e[this.uid]&&e[this.uid][t],s;if(i){if(r){for(s=i.length-1;s>=0;s--)if(i[s].fn===r){i.splice(s,1);break}}else i=[];i.length||(delete e[this.uid][t],n.isEmptyObj(e[this.uid])&&delete e[this.uid])}},removeAllEventListeners:function(){e[this.uid]&&delete e[this.uid]},dispatchEvent:function(t){var r,s,u,a,f,l={};if(n.typeOf(t)!=="string"){f=t;if(n.typeOf(f.type)!=="string")throw new i.EventException(i.EventException.UNSPECIFIED_EVENT_TYPE_ERR);t=f.type,f.total&&f.loaded&&(l.total=f.total,l.loaded=f.loaded)}t.indexOf("::")!==-1?function(e){r=e[0],t=e[1]}(t.split("::")):r=this.uid,t=t.toLowerCase(),s=e[r]&&e[r][t];if(s){s.sort(function(e,t){return t.priority-e.priority}),a=[].slice.call(arguments),a.shift(),l.type=t,a.unshift(l);var c=[];n.each(s,function(e,t){a[0].target=e.scope,l.async?c.push(function(t){setTimeout(function(){t(e.fn.apply(e.scope,a)===!1)},1)}):c.push(function(t){t(e.fn.apply(e.scope,a)===!1)})}),c.length&&n.inSeries(c)}return!0},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(e){var t;n.typeOf(e)!=="array"&&(e=[e]);for(var i=0;i<e.length;i++)t="on"+e[i],n.typeOf(this[t])==="function"?this.addEventListener(e[i],this[t]):this[t]===r&&(this[t]=null)}})}return e}())}(window,document,mOxie),function(e,t,n,r){function u(e,r){var i=this,s=n.guid(r+"_"),u=s+"_container";n.extend(this,{initialized:!1,uid:s,type:r,shimid:u,options:e,can:function(){return i.constructor.can.apply(i,arguments)},getShimContainer:function(){var i,s=n(this.shimid);return s||(i=e.container?n(e.container):t.body,s=t.createElement("div"),s.id=this.shimid,s.className="mOxie-shim mOxie-shim-"+r,n.extend(s.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),i.appendChild(s),i=null),s},getShim:function(){return n(this.uid)},exec:function(e,t){var n=[].slice.call(arguments,2);return i[e]&&i[e][t]?i[e][t].apply(this,n):i.shimExec.apply(this,arguments)},shimExec:function(e,t){var n=[].slice.call(arguments,2);return i.getShim().exec(this.uid,e,t,n)},destroy:function(){var e=this.getShimContainer();e&&(e.parentNode.removeChild(e),e=null),this.unbindAll(),delete o[this.uid]}})}function a(e,t){return o[e]=t,t}function f(e){return o[e]?o[e]:!1}var i=n.Exceptions,s={},o={};u.addConstructor=function(e,t){t.prototype=n.eventTarget,s[e]=t},u.getConstructor=function(e){return s[e]||null},u.getInfo=function(e){var t=f(e);return t?{uid:t.uid,type:t.type,can:t.can}:null},u.order="html5,flash,silverlight,html4",u.caps={access_binary:!0,display_media:!1,drag_and_drop:!1,receive_response_type:!1,resize_image:!1,report_upload_progress:!1,return_response_headers:!0,send_custom_headers:!1,select_multiple:!0,send_binary_string:!1,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:function(e){return n.parseSizeStr(e)<=2097152},use_http_method:!0},u.can=function(t,i,s){if(!i||n.typeOf(i)==="object"&&n.isEmptyObj(i))return!0;n.typeOf(i)==="string"&&s===r&&(i=function(e){var t={};return n.each(e,function(e){t[e]=!0}),t}(i.split(",")));if(n.typeOf(i)==="object"){for(var o in i)if(!u.can.call(this,t,o,i[o]))return!1;return!0}return n.typeOf(t[i])==="function"?t[i].call(this,s):t[i]},n.Runtime=u,n.RuntimeClient=function(){var e=this,t;n.extend(this,{connectRuntime:function(r){var o,l,c,h,p=[],d,v,m;n.typeOf(r)==="string"?o=r:n.typeOf(r.ruid)==="string"&&(o=r.ruid);if(o){t=f(o);if(t)return t;throw new i.RuntimeError(i.RuntimeError.NOT_INIT_ERR)}d=r.runtime_order||u.order,p=d.split(/\s?,\s?/);e:for(l in p){c=p[l];if(!s[c])continue;h=s[c];if(!h.can(r.required_caps))continue e;try{t=new h(r),a(t.uid,t),t.bind("Init",function(){t.initialized=!0,t.constructor=h,setTimeout(function(){e.trigger("RuntimeInit",t)},1)}),t.bind("Exception",function(){}),t.init();return}catch(g){t&&t.destroy()}}throw new i.RuntimeError(i.RuntimeError.NOT_INIT_ERR)},getRuntime:function(){return t||null},disconnectRuntime:function(){}})},n.RuntimeTarget=function(){function e(){this.uid=n.guid("uid_"),n.RuntimeClient.call(this)}return e.prototype=n.eventTarget,e}()}(window,document,mOxie),function(e,t,n,r){function i(){function f(){s=u=0,r=this.result=null}function l(e,a){var f=this;t=a,f.bind("TransportingProgress",function(e){u=e.loaded,u<s&&n.inArray(f.state,[i.IDLE,i.DONE])===-1&&c.call(f)},999),f.bind("TransportingComplete",function(n){u=s,f.state=i.DONE,r=null,f.result=t.exec.call(f,"Transporter","getAsBlob",e||"")},999),f.state=i.BUSY,f.trigger("TransportingStarted"),c.call(f)}function c(){var e=this,i,f=s-u;a>f&&(a=f),i=n.btoa(r.substr(u,a)),t.exec.call(e,"Transporter","receive",i,s)}var e,t,r,s,u,a;n.RuntimeClient.call(this),n.extend(this,{uid:"uid_"+n.guid(),state:i.IDLE,result:null,transport:function(t,i,u){var c=this;u=n.extend({chunk_size:204798},u);if(e=u.chunk_size%3)u.chunk_size+=3-e;a=u.chunk_size,f.call(this),r=t,s=t.length;if(n.typeOf(u)==="string"||u.ruid)l.call(c,i,this.connectRuntime(u));else{var h=function(e,t){c.unbind("RuntimeInit",h),l.call(c,i,t)};this.bind("RuntimeInit",h),this.connectRuntime(u)}},abort:function(){this.state=i.IDLE,t&&(t.exec.call(self,"Transporter","clear"),this.trigger("TransportingAborted")),f.call(this)},destroy:function(){f.call(this),this.unbindAll()},constructor:i})}i.IDLE=0,i.BUSY=1,i.DONE=2,i.prototype=n.eventTarget,n.Transporter=i}(window,document,mOxie),function(e,t,n,r){var i=n.Exceptions;(function(){var e={};n.Blob=function(){function t(t,r){function i(t,r,i){var s,u=e[this.uid];return n.typeOf(u)!=="string"||!u.length?null:(s=new n.Blob(null,{type:i,size:r-t}),s.detach(u.substr(t,s.size)),s)}function s(){return n.typeOf(n.connectRuntime)!=="function"&&n.RuntimeClient.call(this),this.connectRuntime(this.ruid)}r||(r={}),n.extend(this,{uid:n.guid("uid_"),ruid:t,size:r.size||0,type:r.type||"",slice:function(e,t,n){return this.isDetached()?i.apply(this,arguments):s.call(this).exec.call(this,"Blob","slice",this.getSource(),e,t,n)},getSource:function(){return e[this.uid]?e[this.uid]:null},detach:function(t){this.ruid&&(s.call(this).exec.call(this,"Blob","destroy",e[this.uid]),this.ruid=null),e[this.uid]=t||""},isDetached:function(){return!this.ruid&&n.typeOf(e[this.uid])==="string"},destroy:function(){this.detach(),delete e[this.uid]},constructor:n.Blob}),r.data?this.detach(r.data):e[this.uid]=r}return t}(),n.File=function(){function e(e,t){var r,i,s;t||(t={}),i=t.name&&t.name.match(/[^\.]+$/),t.type||(s=i&&n.mimes[i[0].toLowerCase()]||"application/octet-stream"),t.name?(r=t.name.replace(/\\/g,"/"),r=r.substr(r.lastIndexOf("/")+1)):t.type&&n.extensions[t.type]&&(i=n.extensions[t.type][0],r=n.guid(t.type.split("/")[0]+"_"||"file_")+"."+i),n.Blob.apply(this,arguments),n.extend(this,{type:t.type||s,name:r||"",lastModifiedDate:t.lastModifiedDate||(new Date).toLocaleString(),constructor:n.File})}return e.prototype=n.Blob.prototype,e}()})(),n.BlobBuilder=function(){function e(){function t(){var t,r="";return n.each(e,function(e){if(n.typeOf(e)==="string")r+=e;else if(e instanceof n.Blob){var t=new n.FileReaderSync;r+=t.readAsBinaryString(e)}}),r}var e=[];n.extend(this,{uid:n.guid("uid_"),append:function(t){if(!(n.typeOf(t)==="string"&&t instanceof n.Blob))throw new i.DOMException(i.DOMException.TYPE_MISMATCH_ERR);e.push(t)},getBlob:function(e){var r=t(),i;return i=new n.Blob(null,{size:r.length,type:e}),i.detach(r),i},getFile:function(e,r){var i=t(),s;return s=new n.File(null,{size:i.length,type:e,name:r}),s.detach(i),s},destroy:function(){e=[]},constructor:n.BlobBuilder})}return e}(),n.FileReader=function(){function t(){function u(n,o){r.readyState=t.EMPTY,r.error=null;if(r.readyState===t.LOADING||!o.ruid||!o.uid)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);this.convertEventPropsToHandlers(e),s=r.connectRuntime(o.ruid),r.bind("Error",function(e,n){r.readyState=t.DONE,r.result=null,r.error=n,r.trigger("loadend")},999),r.bind("LoadStart",function(){r.readyState=t.LOADING},999),r.bind("Load",function(e){r.readyState=t.DONE,r.trigger("loadend")},999),s.exec.call(r,"FileReader","read",n,o)}var r=this,s;n.RuntimeClient.call(r),n.extend(r,{uid:n.guid("uid_"),readyState:t.EMPTY,result:null,error:null,readAsBinaryString:function(e){this.result="",u.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){u.call(this,"readAsDataURL",e)},readAsArrayBuffer:function(e){u.call(this,"readAsArrayBuffer",e)},readAsText:function(e){u.call(this,"readAsText",e)},abort:function(){if(!s)return;this.result=null;if(!!~n.inArray(this.readyState,[t.EMPTY,t.DONE]))return;this.readyState===t.LOADING&&(this.readyState=t.DONE),r.bind("Abort",function(){r.trigger("loadend")}),s.exec("FileReader","abort")},constructor:t})}var e=["loadstart","progress","load","abort","error","loadend"];return t.EMPTY=0,t.LOADING=1,t.DONE=2,t.prototype=n.eventTarget,t}(),n.FileReaderSync=function(){function e(){function e(e,t){if(t.isDetached()){var r=t.getSource();switch(e){case"readAsBinaryString":return r;case"readAsDataURL":return"data:"+t.type+";base64,"+n.btoa(r);case"readAsText":var i="";for(var s=0,u=r.length;s<u;s++)i+=String.fromCharCode(r[s]);return i}}else try{return this.connectRuntime(t.ruid).exec.call(this,"FileReaderSync","read",e,t)}catch(a){}}n.RuntimeClient.call(this),n.extend(this,{uid:n.guid("uid_"),readAsBinaryString:function(t){return e.call(this,"readAsBinaryString",t)},readAsDataURL:function(t){return e.call(this,"readAsDataURL",t)},readAsText:function(t){return e.call(this,"readAsText",t)}})}return e}(),n.FileInput=function(){function s(u){var a=this,f,l,c;typeof u=="string"&&(u={browse_button:u}),l=n(u.browse_button);if(!l)throw new i.DOMException(i.DOMException.NOT_FOUND_ERR);c={accept:[{title:n.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:l.parentNode||t.body},u=typeof u=="object"?n.extend({},c,u):c,typeof u.accept=="string"&&(u.accept=n.mimes2extList(u.accept)),f=n(u.container),n.getStyle(f,"position")==="static"&&(f.style.position="relative"),f=l=null,n.RuntimeClient.call(a),n.extend(a,{uid:n.guid("uid_"),ruid:null,files:null,init:function(){a.convertEventPropsToHandlers(e),a.bind("RuntimeInit",function(e,t){a.ruid=t.uid,a.bind("Change",function(e){var r=t.exec.call(a,"FileInput","getFiles");a.files=[],n.each(r,function(e){a.files.push(new n.File(a.ruid,e))})},999),t.exec.call(a,"FileInput","init",u),a.bind("Refresh",function(){var e,r,i;i=n(u.browse_button),i&&(e=n.getPos(i,n(u.container)),r=n.getSize(i),n.extend(t.getShimContainer().style,{top:e.y+"px",left:e.x+"px",width:r.w+"px",height:r.h+"px"}),i=null)}),a.trigger("Refresh"),a.dispatchEvent("ready")}),a.connectRuntime(u)},disable:function(e){var t=this.getRuntime();t&&t.exec.call(this,"FileInput","disable",e===r?!0:e)},constructor:s})}var e=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return s.prototype=n.eventTarget,s}(),n.FileDrop=function(){function r(i){var s=this,u;typeof i=="string"&&(i={drop_zone:i}),u={accept:[{title:n.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},i=typeof i=="object"?n.extend({},u,i):u,i.container=n(i.drop_zone)||t.body,n.getStyle(i.container,"position")==="static"&&(i.container.style.position="relative"),typeof i.accept=="string"&&(i.accept=n.mimes2extList(i.accept)),n.RuntimeClient.call(s),n.extend(s,{uid:n.guid("uid_"),ruid:null,files:null,init:function(){s.convertEventPropsToHandlers(e),s.bind("RuntimeInit",function(e,t){s.ruid=t.uid,s.bind("Drop",function(e){var r=t.exec.call(s,"FileDrop","getFiles");s.files=[],n.each(r,function(e){s.files.push(new n.File(s.ruid,e))})},999),t.exec.call(s,"FileDrop","init"),s.dispatchEvent("ready")}),s.connectRuntime(i)},constructor:r})}var e=["ready","dragleave","dragenter","drop","error"];return r.prototype=n.eventTarget,r}()}(window,document,mOxie),function(e,t,n,r){var i=n.Exceptions;n.Image=function(){function t(){function s(e){e||(e=this.connectRuntime(this.ruid).exec.call(this,"Image","getInfo"));if(e&&n.typeOf(e.meta)==="string")try{this.meta=n.JSON.parse(e.meta)}catch(t){}n.extend(this,{size:e.size,width:e.width,height:e.height,type:e.type}),this.name===""&&(this.name=e.name)}function u(e,n){var i=this.connectRuntime(e.ruid);this.ruid=i.uid,i.exec.call(t,"Image","loadFromImage",e,n===r?!0:n)}function a(e,n){function r(r){t.ruid=r.uid,r.exec.call(t,"Image","loadFromBlob",e,n)}t.name=e.name||"",e.isDetached()?(this.bind("RuntimeInit",function(e,t){r(t)}),this.connectRuntime({required_caps:{access_image_binary:!0,resize_image:!0}})):r(this.connectRuntime(e.ruid))}function f(e,r){var i;i=new n.XMLHttpRequest,i.open("get",e),i.responseType="blob",i.onprogress=function(e){t.trigger(e)},i.onload=function(){a.call(t,i.response,!0)},i.onerror=function(e){t.trigger(e)},i.onloadend=function(){t.trigger("onloadend"),i.unbindAll()},t.trigger("loadstart"),i.send(null,r)}var t=this;n.RuntimeClient.call(this),n.extend(this,{uid:n.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(r){var s,l,c;this.convertEventPropsToHandlers(e);try{if(r instanceof n.Image){if(!r.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);u.apply(this,arguments)}else if(r instanceof n.File||r instanceof n.Blob){if(!~n.inArray(r.type,["image/jpeg","image/png"]))throw new i.ImageError(i.ImageError.WRONG_FORMAT);a.apply(this,arguments)}else if(n.typeOf(r)==="string"&&/^http:\/\//.test(r))f.apply(this,arguments);else{if(!(s=n(r)&&s.nodeName==="img"))throw new i.DOMException(i.DOMException.TYPE_MISMATCH_ERR);c=n.parseUrl(s.src),l=c.scheme+"://"+c.host+(c.port!==80?":"+c.port:"")+c.path,f.apply(this,arguments)}}catch(h){t.trigger("error")}},resize:function(e,n,o){var u;if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);if(!e)throw new i.DOMException(i.DOMException.SYNTAX_ERR);n||(n=e),u=this.connectRuntime(this.ruid),t.bind("Resize",function(e,t){s.call(this,t)},999),u.exec.call(t,"Image","resize",e,n,o===r?!1:o)},crop:function(e,t){this.resize(e,t,!0)},getAsCanvas:function(){if(!n.ua.can("create_canvas"))throw new i.RuntimeError(i.RuntimeError.NOT_SUPPORTED_ERR);var e=this.connectRuntime(this.ruid);return e.exec.call(t,"Image","getAsCanvas")},getAsImage:function(){var e=this.connectRuntime(this.ruid);return e.exec.call(t,"Image","getAsImage")},getAsBlob:function(e,n){if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);return e||(e="image/jpeg"),e==="image/jpeg"&&!n&&(n=90),this.connectRuntime(this.ruid).exec.call(t,"Image","getAsBlob",e,n)},getAsDataURL:function(e,n){if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);return this.connectRuntime(this.ruid).exec.call(t,"Image","getAsDataURL",e,n)},getAsBinaryString:function(e,t){var r,i;return r=this.getAsBlob(e,t),i=new n.FileReaderSync,i.readAsBinaryString(r)},embed:function(e){function d(){var r,u=u||this.type||"image/jpeg";if(n.ua.can("create_canvas")){var f=s.getAsCanvas();if(f){e.appendChild(f),f=null,s.destroy(),t.trigger("embedded");return}}r=s.getAsDataURL(u,a);if(!r)throw new i.ImageError(i.ImageError.WRONG_FORMAT);if(n.ua.can("use_data_uri_of",s.size))e.innerHTML='<img src="'+r+'" width="'+s.width+'" height="'+s.height+'" />',s.destroy(),t.trigger("embedded");else{var d=new n.Transporter;d.bind("TransportingComplete",function(){p=t.connectRuntime(this.result.ruid),t.bind("Embedded",function(){n.extend(p.getShimContainer().style,{top:"0px",left:"0px",width:s.width+"px",height:s.height+"px"})},999),p.exec.call(t,"ImageView","display",this.result.getSource().id,c,h),s.destroy()}),d.transport(n.atob(r.substring(r.indexOf("base64,")+7)),u,n.extend({},l,{required_caps:{display_media:!0},container:e}))}}var s,u,a,f,l=arguments[1]||{},c=this.width,h=this.height,p;if(!(e=n(e)))throw new i.DOMException(i.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);return u=l.type,a=l.quality||90,crop=l.crop!==r?l.crop:!1,l.width?(c=l.width,h=l.height||c):(f=n.getSize(e),f.w&&f.h&&(c=f.w,h=f.h)),s=new n.Image,s.bind("Resize",function(){d.call(t)}),s.bind("Load",function(){s.resize(c,h,crop)}),s.clone(this,!1),s},destroy:function(){if(this.ruid){var e=this.connectRuntime(this.ruid);e.exec.call(t,"Image","destroy")}this.unbindAll()},constructor:n.Image}),n.defineProperty(this,"src",{configurable:!1,set:function(e){this.load(e)}}),this.bind("load",function(e,t){s.call(this,t)},999)}var e=["loadstart","progress","load","error","loadend","resize","embedded"];return t.prototype=n.eventTarget,t}(),n.ImageEditor=function(){function e(e){var t=this,r="rotate flipH flipV resize crop sharpen emboss".split(/\s+/);if(!e||!e.size)throw new i.DOMException(i.DOMException.TYPE_MISMATCH_ERR);n.RuntimeClient.call(this),n.each(r,function(e){t[e]=function(){var n;if(!this.ruid)throw new i.RuntimeError(i.RuntimeError.NOT_INIT_ERR);return n=this.connectRuntime(this.ruid),n.exec.call(t,"ImageEditor",e),t}})}return e}()}(window,document,mOxie),function(e,t,n,r){function a(){function n(n,r){var i=e?0:-8*(r-1),s=0,o;for(o=0;o<r;o++)s|=t.charCodeAt(n+o)<<Math.abs(i+o*8);return s}function i(e,n,r){var r=arguments.length===3?r:t.length-n-1;t=t.substr(0,n)+e+t.substr(r+n)}function s(t,n,r){var s="",o=e?0:-8*(r-1),u;for(u=0;u<r;u++)s+=String.fromCharCode(n>>Math.abs(o+u*8)&255);i(s,t,r)}var e=!1,t;return{II:function(t){if(t===r)return e;e=t},init:function(n){e=!1,t=n},SEGMENT:function(e,n,r){switch(arguments.length){case 1:return t.substr(e,t.length-e-1);case 2:return t.substr(e,n);case 3:i(r,e,n);break;default:return t}},BYTE:function(e){return n(e,1)},SHORT:function(e){return n(e,2)},LONG:function(e,t){if(t===r)return n(e,4);s(e,t,4)},SLONG:function(e){var t=n(e,4);return t>2147483647?t-4294967296:t},STRING:function(e,t){var r="";for(t+=e;e<t;e++)r+=String.fromCharCode(n(e,1));return r}}}var s,o,u=n.Exceptions;n.ImageInfo=function(e){var t=[s,o],r;r=function(){for(var n=0;n<t.length;n++)try{return new t[n](e)}catch(r){}throw new u.ImageError(u.ImageError.WRONG_FORMAT)}(),n.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(e){return e},purge:function(){}}),n.extend(this,r),this.purge=r.purge},s=function(){function e(e){function h(){var e=0,t,n;while(e<=r.length){t=i.SHORT(e+=2);if(t>=65472&&t<=65475)return e+=5,{height:i.SHORT(e),width:i.SHORT(e+=2)};n=i.SHORT(e+=2),e+=n-2}return null}function p(){f.purge(),o.purge(),i.init(null),o=f=i=null}var r,i,o,f,l,c;r=e,i=new a,i.init(r);if(i.SHORT(0)!==65496)throw new u.ImageError(u.ImageError.WRONG_FORMAT);o=new t(e),f=new s,c=!!f.init(o.get("exif")[0]),l=h.call(this),n.extend(this,{type:"image/jpeg",size:r.length,width:l&&l.width||0,height:l&&l.height||0,setExif:function(e,t){if(!c)return!1;n.typeOf(e)==="object"?n.each(e,function(e,t){f.setExif(t,e)}):f.setExif(e,t),o.set("exif",f.getBinary())},writeHeaders:function(){return arguments.length?o.restore(arguments[0]):r=o.restore(r)},purge:function(){p.call(this)}}),c&&(this.meta={exif:f.EXIF(),gps:f.GPS()})}function t(e){var n={65505:{app:"EXIF",name:"APP1",signature:"Exif\0"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\0"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\0"}},r=[],i,s,o,u=0,f;i=new a,i.init(e);if(i.SHORT(0)!==65496)return;s=2,f=Math.min(1048576,e.length);while(s<=f){o=i.SHORT(s);if(o>=65488&&o<=65495){s+=2;continue}if(o===65498||o===65497)break;u=i.SHORT(s+2)+2,n[o]&&i.STRING(s+4,n[o].signature.length)===n[o].signature&&r.push({hex:o,app:n[o].app.toUpperCase(),name:n[o].name.toUpperCase(),start:s,length:u,segment:i.SEGMENT(s,u)}),s+=u}return i.init(null),{headers:r,restore:function(e){i.init(e);var n=new t(e);if(!n.headers)return!1;for(var o=n.headers.length;o>0;o--){var u=n.headers[o-1];i.SEGMENT(u.start,u.length,"")}n.purge(),s=i.SHORT(2)==65504?4+i.SHORT(4):2;for(var o=0,a=r.length;o<a;o++)i.SEGMENT(s,0,r[o].segment),s+=r[o].length;return e=i.SEGMENT(),i.init(null),e},get:function(e){var t=[];for(var n=0,i=r.length;n<i;n++)r[n].app===e.toUpperCase()&&t.push(r[n].segment);return t},set:function(e,t){var n=[];typeof t=="string"?n.push(t):n=t;for(var i=ii=0,s=r.length;i<s;i++){r[i].app===e.toUpperCase()&&(r[i].segment=n[ii],r[i].length=n[ii].length,ii++);if(ii>=n.length)break}},purge:function(){r=[],i.init(null)}}}function s(){function u(t,n){var i=e.SHORT(t),u,a,f,l,c,h,p,d,v=[],m={};for(u=0;u<i;u++){p=h=t+12*u+2,f=n[e.SHORT(p)];if(f===r)continue;l=e.SHORT(p+=2),c=e.LONG(p+=2),p+=4,v=[];switch(l){case 1:case 7:c>4&&(p=e.LONG(p)+s.tiffHeader);for(a=0;a<c;a++)v[a]=e.BYTE(p+a);break;case 2:c>4&&(p=e.LONG(p)+s.tiffHeader),m[f]=e.STRING(p,c-1);continue;case 3:c>2&&(p=e.LONG(p)+s.tiffHeader);for(a=0;a<c;a++)v[a]=e.SHORT(p+a*2);break;case 4:c>1&&(p=e.LONG(p)+s.tiffHeader);for(a=0;a<c;a++)v[a]=e.LONG(p+a*4);break;case 5:p=e.LONG(p)+s.tiffHeader;for(a=0;a<c;a++)v[a]=e.LONG(p+a*4)/e.LONG(p+a*4+4);break;case 9:p=e.LONG(p)+s.tiffHeader;for(a=0;a<c;a++)v[a]=e.SLONG(p+a*4);break;case 10:p=e.LONG(p)+s.tiffHeader;for(a=0;a<c;a++)v[a]=e.SLONG(p+a*4)/e.SLONG(p+a*4+4);break;default:continue}d=c==1?v[0]:v,o.hasOwnProperty(f)&&typeof d!="object"?m[f]=o[f][d]:m[f]=d}return m}function f(){var n=r,i=s.tiffHeader;return e.II(e.SHORT(i)==18761),e.SHORT(i+=2)!==42?!1:(s.IFD0=s.tiffHeader+e.LONG(i+=2),n=u(s.IFD0,t.tiff),"ExifIFDPointer"in n&&(s.exifIFD=s.tiffHeader+n.ExifIFDPointer),"GPSInfoIFDPointer"in n&&(s.gpsIFD=s.tiffHeader+n.GPSInfoIFDPointer),!0)}function l(n,r,o){var u,a,f,l=0;if(typeof r=="string"){var c=t[n.toLowerCase()];for(hex in c)if(c[hex]===r){r=hex;break}}u=s[n.toLowerCase()+"IFD"],a=e.SHORT(u);for(i=0;i<a;i++){f=u+12*i+2;if(e.SHORT(f)==r){l=f+8;break}}return l?(e.LONG(l,o),!0):!1}var e,t,s={},o;return e=new a,t={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},o={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(t){return s={tiffHeader:10},t===r||!t.length?!1:(e.init(t),e.SHORT(0)===65505&&e.STRING(4,5).toUpperCase()==="EXIF\0"?f():!1)},EXIF:function(){var e;e=u(s.exifIFD,t.exif);if(e.ExifVersion&&n.typeOf(e.ExifVersion)==="array"){for(var r=0,i="";r<e.ExifVersion.length;r++)i+=String.fromCharCode(e.ExifVersion[r]);e.ExifVersion=i}return e},GPS:function(){var e;return e=u(s.gpsIFD,t.gps),e.GPSVersionID&&n.typeOf(e.GPSVersionID)==="array"&&(e.GPSVersionID=e.GPSVersionID.join(".")),e},setExif:function(e,t){return e!=="PixelXDimension"&&e!=="PixelYDimension"?!1:l("exif",e,t)},getBinary:function(){return e.SEGMENT()},purge:function(){e.init(null)}}}return e}(),o=function(){function e(e){function f(){var e,t;return e=l.call(this,8),e.type=="IHDR"?(t=e.start,{width:r.LONG(t),height:r.LONG(t+=4)}):null}function l(e){var t,n,i,s;return t=r.LONG(e),n=r.STRING(e+=4,4),i=e+=4,s=r.LONG(e+t),{length:t,type:n,start:i,CRC:s}}function c(){r.init(null),i=s=r=null}var t,r,i,s,o;t=e,r=new a,r.init(t),function(){var e=n=0,t=[35152,20039,3338,6666];for(var n=0;n<t.length;n++,e+=2)if(t[n]!=r.SHORT(e))throw new u.ImageError(u.ImageError.WRONG_FORMAT)}(),o=f.call(this),n.extend(this,{type:"image/png",size:t.length,width:o.width,height:o.height,purge:function(){c.call(this)}}),c.call(this)}return e}()}(window,document,mOxie),function(e,t,n,r){function o(){n.extend(this,{_blob:null,_fields:{},append:function(e,t){if(t instanceof n.Blob||t instanceof n.File){if(this._blob)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);this._blob=e}this._fields[e]=t},constructor:o})}var i=n.Exceptions,s={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};n.FormData=o,n.XMLHttpRequestUpload=function(){function e(){this.uid=n.guid("uid_"),this.constructor=n.XMLHttpRequestUpload}return e.prototype=n.eventTarget,e}(),n.XMLHttpRequest=function(){function a(){function _(e,t){if(!l.hasOwnProperty(e))return;if(arguments.length===1)return n.ua.can("define_property")?l[e]:f[e];n.ua.can("define_property")?l[e]=t:f[e]=t}function D(e,t,n){return e.toLowerCase()}function P(e){function t(e){return[e.scheme,e.host,e.port].join("/")}return typeof e=="string"&&(e=n.parseUrl(e)),t(n.parseUrl())===t(e)}function H(){return!e.XMLHttpRequest||n.ua.browser==="IE"&&n.ua.version<8?function(){var e=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"];for(var t=0;t<e.length;t++)try{return new ActiveXObject(e[t])}catch(n){}}():new e.XMLHttpRequest}function B(t){var r=t.responseXML,i=t.responseText;n.ua.browser==="IE"&&i&&r&&!r.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(t.getResponseHeader("Content-Type"))&&(r=new e.ActiveXObject("Microsoft.XMLDOM"),r.async=!1,r.validateOnParse=!1,r.loadXML(i));if(r)if(n.ua.browser==="IE"&&r.parseError!==0||!r.documentElement||r.documentElement.tagName==="parsererror")return null;return r}function j(e){var t=this,i=0;M=o,O=H(),O.onreadystatechange=function s(){_("readyState")>a.HEADERS_RECEIVED&&(_("status",O.status),_("statusText",O.statusText)),_("readyState",O.readyState),t.dispatchEvent("readystatechange");switch(_("readyState")){case a.OPENED:s.loadstartDispatched===r&&(t.dispatchEvent("loadstart"),s.loadstartDispatched=!0);break;case a.HEADERS_RECEIVED:try{i=O.getResponseHeader("Content-Length")||0}catch(e){}break;case a.LOADING:var n=0;try{O.responseText&&(n=O.responseText.length)}catch(e){n=0}t.dispatchEvent({type:"progress",lengthComputable:!!i,total:parseInt(i,10),loaded:n});break;case a.DONE:O.onreadystatechange=new Function,O.status===0||O.status>=400?(T=!0,t.dispatchEvent("error")):(_("responseText",O.responseText),_("responseXML",B(O)),_("response",_("responseType")==="document"?_("responseXML"):_("responseText")),t.dispatchEvent("load")),t.dispatchEvent("loadend")}},O.open(p,h,c,v,m),n.isEmptyObj(d)||n.each(d,function(e,t){O.setRequestHeader(t,e)}),O.send()}function F(e){function r(r){O.bind("LoadStart",function(e){_("readyState",a.LOADING),t.trigger(e),E&&t.upload.trigger(e)}),O.bind("Progress",function(e){_("readyState",a.LOADING),t.trigger(e)}),O.bind("UploadProgress",function(e){E&&t.upload.trigger({type:"progress",lengthComputable:!1,total:e.total,loaded:e.loaded})}),O.bind("Load",function(e){_("readyState",a.DONE),_("status",Number(r.exec.call(O,"XMLHttpRequest","getStatus")||0)),_("statusText",s[_("status")]||""),_("response",r.exec.call(O,"XMLHttpRequest","getResponse",_("responseType"))),~n.inArray(_("responseType"),["text",""])?_("responseText",_("response")):_("responseType")==="document"&&_("responseXML",_("response")),E&&t.upload.trigger(e),t.trigger(e),t.trigger("loadend")}),O.bind("Abort",function(e){t.trigger(e),t.trigger("loadend")}),O.bind("Error",function(e){T=!0,t.trigger(e),t.trigger("loadend")}),O.bind("LoadEnd",function(e){O.unbindAll()}),r.exec.call(O,"XMLHttpRequest","send",{url:h,method:p,async:c,user:v,password:m,headers:d,mimeType:y,encoding:g,responseType:l.responseType,options:A},e)}var t=this;M=u,O=new n.RuntimeTarget,A.required_caps=n.extend({},A.required_caps,{receive_response_type:l.responseType}),A.ruid?r(O.connectRuntime(A)):(O.bind("RuntimeInit",function(e,t){r(t)}),O.connectRuntime(A))}function I(e){N=(new Date).getTime(),q.call(this)?j.call(this,e):F.call(this,e),!P(h)}function q(){return p==="HEAD"||p==="GET"&&!!~n.inArray(_("responseType"),["","text","document"])||p==="POST"&&d["Content-Type"]==="application/x-www-form-urlencoded"}function R(){_("responseText",""),_("responseXML",null),_("response",null),_("status",0),_("statusText",""),N=r,C=r}var f=this,l={timeout:0,readyState:a.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},c=!0,h,p,d={},v,m,g=null,y=null,b=!1,w=!1,E=!1,S=!1,T=!1,N,C,k=null,L=null,A={},O,M=o;n.extend(this,l,{uid:"uid_"+n.guid(),upload:new n.XMLHttpRequestUpload,constructor:n.XMLHttpRequest,open:function(e,t,r,s,o){var u;if(!e||!t)throw new i.DOMException(i.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(e)||n.utf8_encode(e)!==e)throw new i.DOMException(i.DOMException.SYNTAX_ERR);!~n.inArray(e.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])||(p=e.toUpperCase());if(!!~n.inArray(p,["CONNECT","TRACE","TRACK"]))throw new i.DOMException(i.DOMException.SECURITY_ERR);t=n.utf8_encode(t),u=n.parseUrl(t),h=n.resolveUrl(t);if((s||o)&&!P(u))throw new i.DOMException(i.DOMException.INVALID_ACCESS_ERR);v=s||u.user,m=o||u.pass,c=r||!0;if(c===!1&&(_("timeout")||_("withCredentials")||_("responseType")!==""))throw new i.DOMException(i.DOMException.INVALID_ACCESS_ERR);b=!c,w=!1,d={},R.call(this),_("readyState",a.OPENED),this.convertEventPropsToHandlers(["readystatechange"]),this.dispatchEvent("readystatechange")},setRequestHeader:function(e,t){var r=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(_("readyState")!==a.OPENED||w)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(e)||n.utf8_encode(e)!==e)throw new i.DOMException(i.DOMException.SYNTAX_ERR);return e=n.trim(e).toLowerCase(),!!~n.inArray(e,r)||/^(proxy\-|sec\-)/.test(e)?!1:(d[e]?d[e]+=", "+t:d[e]=t,!0)},overrideMimeType:function(e){var t,r;if(!!~n.inArray(_("readyState"),[a.LOADING,a.DONE]))throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);e=n.trim(e.toLowerCase()),/;/.test(e)&&(t=e.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(e=t[1],t[2]&&(r=t[2]));if(!n.mimes[e])throw new i.DOMException(i.DOMException.SYNTAX_ERR);k=e,L=r},send:function(e,r){var s=this;n.typeOf(r)==="string"?A={ruid:r}:r?A=r:A={},this.convertEventPropsToHandlers(t),this.upload.convertEventPropsToHandlers(t);if(this.readyState!==a.OPENED||w)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);if(!q())if(e instanceof n.Blob)A.ruid=e.ruid,y=e.type;else if(e instanceof n.FormData){if(e._blob){var o=e._fields[e._blob];A.ruid=o.ruid,y=o.type}}else typeof e=="string"&&(g="UTF-8",y="text/plain;charset=UTF-8",e=n.utf8_encode(e));E=!b&&this.upload.hasEventListener(),T=!1,S=!e,b||(w=!0,this.dispatchEvent("readystatechange"),!S),I.call(s,e)},abort:function(){var e;T=!0,b=!1;if(!~n.inArray(_("readyState"),[a.UNSENT,a.OPENED,a.DONE])){_("readyState",a.DONE),w=!1;if(M===o)O.abort(),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort"),this.dispatchEvent("loadend"),S||(this.upload.dispatchEvent("abort"),this.upload.dispatchEvent("loadend"));else{if(n.typeOf(O.getRuntime)!=="function"||!(e=O.getRuntime()))throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);e.exec.call(O,"XMLHttpRequest","abort",S)}S=!0}else _("readyState",a.UNSENT)},toString:function(){return"[object XMLHttpRequest]"}}),n.defineProperty(this,"readyState",{configurable:!1,get:function(){return _("readyState")}}),n.defineProperty(this,"timeout",{configurable:!1,get:function(){return _("timeout")},set:function(e){if(b)throw new i.DOMException(i.DOMException.INVALID_ACCESS_ERR);C=(new Date).getTime(),_("timeout",e)}}),n.defineProperty(this,"withCredentials",{configurable:!1,get:function(){return _("withCredentials")},set:function(e){if(!~n.inArray(_("readyState"),[a.UNSENT,a.OPENED])||w)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);if(_anonymous_flag||b)throw new i.DOMException(i.DOMException.INVALID_ACCESS_ERR);_("withCredentials",e)}}),n.defineProperty(this,"status",{configurable:!1,get:function(){return _("status")}}),n.defineProperty(this,"statusText",{configurable:!1,get:function(){return _("statusText")}}),n.defineProperty(this,"responseType",{configurable:!1,get:function(){return _("responseType")},set:function(e){if(!!~n.inArray(_("readyState"),[a.LOADING,a.DONE]))throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);if(b)throw new i.DOMException(i.DOMException.INVALID_ACCESS_ERR);_("responseType",e.toLowerCase())}}),n.defineProperty(this,"responseText",{configurable:!1,get:function(){if(!~n.inArray(_("responseType"),["","text"]))throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);if(_("readyState")!==a.DONE&&_("readyState")!==a.LOADING||T)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);return _("responseText")}}),n.defineProperty(this,"responseXML",{configurable:!1,get:function(){if(!~n.inArray(_("responseType"),["","document"]))throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);if(_("readyState")!==a.DONE||T)throw new i.DOMException(i.DOMException.INVALID_STATE_ERR);return _("responseXML")}}),n.defineProperty(this,"response",{configurable:!1,get:function(){if(!!~n.inArray(_("responseType"),["","text"]))if(_("readyState")!==a.DONE&&_("readyState")!==a.LOADING||T)return"";return _("readyState")!==a.DONE||T?null:_("response")}})}var t=["loadstart","progress","abort","error","load","timeout","loadend"],o=1,u=2;return a.UNSENT=0,a.OPENED=1,a.HEADERS_RECEIVED=2,a.LOADING=3,a.DONE=4,a.prototype=n.eventTarget,a}()}(window,document,mOxie),function(e,t,n,r){var i="html5",s=n.Exceptions;n.Runtime.addConstructor(i,function(){function r(r){var u=this,a;defaults={},r=typeof r=="object"?n.extend(defaults,r):defaults,n.Runtime.apply(this,[r,arguments[1]||i]),n.extend(this,{init:function(){if(!e.File)throw u.destroy(),new s.RuntimeError(s.RuntimeError.NOT_INIT_ERR);u.trigger("Init")},getShim:function(){return a},shimExec:function(e,t){var n=[].slice.call(arguments,2);return u.getShim().exec.call(this,this.uid,e,t,n)},FileInput:function(){var e=[];return{init:function(t){var r=this,i,s,a;e=[],a=t.accept.mimes||n.extList2mimes(t.accept),s=u.getShimContainer(),s.innerHTML='<input id="'+u.uid+'" type="file" style="font-size:999px;opacity:0;"'+(t.multiple?'multiple="multiple"':"")+' accept="'+a.join(",")+'" />',i=n(u.uid),n.extend(i.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),function(){var e,a,f;e=n(t.browse_button),u.can("summon_file_dialog")&&(n.getStyle(e,"position")==="static"&&(e.style.position="relative"),a=parseInt(n.getStyle(e,"z-index"),10)||1,e.style.zIndex=a,s.style.zIndex=a-1,n.addEvent(e,"click",function(e){i&&!i.disabled&&i.click(),e.preventDefault()},r.uid)),f=u.can("summon_file_dialog")?e:s,n.addEvent(f,"mouseover",function(){r.trigger("mouseenter")},r.uid),n.addEvent(f,"mouseout",function(){r.trigger("mouseleave")},r.uid),n.addEvent(f,"mousedown",function(){r.trigger("mousedown")},r.uid),n.addEvent(n(t.container),"mouseup",function(){r.trigger("mouseup")},r.uid)}(),i.onchange=function(){e=[].slice.call(this.files),this.value="",r.trigger("change")}},getFiles:function(){return e},disable:function(e){var t;if(t=n(u.uid))t.disabled=!!e}}}(),FileDrop:function(){var e=[];return{init:function(){var i=this,s=r.container;if(n.ua.browser==="Safari"&&n.ua.OS==="Windows"&&n.ua.version<5.2){n.getStyle(s,"position")==="static"&&n.extend(s.style,{position:"relative"}),n.addEvent(s,"dragenter",function(r){var a=n(u.uid+"_drop");r.preventDefault(),r.stopPropagation(),a||(a=t.createElement("input"),a.setAttribute("type","file"),a.setAttribute("id",u.uid+"_drop"),a.setAttribute("multiple","multiple"),s.appendChild(a)),a.onchange=function(){var t={};e=[],n.each(this.files,function(n){t[n.name]||(e.push(n),t[n.name]=!0)}),a.parentNode.removeChild(a),i.trigger("drop")},n.extend(a.style,{position:"absolute",display:"block",top:0,left:0,right:0,bottom:0,opacity:0}),i.trigger("dragenter")},i.uid),n.addEvent(s,"dragleave",function(e){var t=n(u.uid+"_drop");t||t.parentNode.removeChild(t),e.preventDefault(),e.stopPropagation(),i.trigger("dragleave")},i.uid);return}n.addEvent(s,"dragover",function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},i.uid),n.addEvent(s,"drop",function(t){t.preventDefault(),t.stopPropagation(),e=t.dataTransfer.files,i.trigger("drop")},i.uid),n.addEvent(s,"dragenter",function(e){e.preventDefault(),e.stopPropagation(),i.trigger("dragenter")},i.uid),n.addEvent(s,"dragleave",function(e){e.preventDefault(),e.stopPropagation(),i.trigger("dragleave")},i.uid)},getFiles:function(){return e}}}(),FileReader:{read:function(e,t){var r=this,i=new FileReader;(function(){function t(e){!~n.inArray(e.type,["progress","load"])||(r.result=i.result),r.trigger(e)}function s(){n.each(e,function(e){i.removeEventListener(e,t)}),i.removeEventListener("loadend",s)}var e=["loadstart","progress","load","abort","error","loadend"];n.each(e,function(e){i.addEventListener(e,t)}),i.addEventListener("loadend",s)})(),n.typeOf(i[e])==="function"&&i[e](t.getSource())}},Blob:{slice:function(e,t,r,i){function s(e,t,n){var r;if(!File.prototype.slice)return(r=File.prototype.webkitSlice||File.prototype.mozSlice)?r.call(e,t,n):null;try{return e.slice(),e.slice(t,n)}catch(i){return e.slice(t,n-t)}}return new n.Blob(u.uid,s.apply(this,arguments))}}}),a=function(){var r={};return{exec:function(e,t,n,i){var o;if(!a[t])throw new s.RuntimeError(s.RuntimeError.NOT_SUPPORTED_ERR);o=r[e],o||(o=r[e]=new a[t]);if(!o[n])throw new s.RuntimeError(s.RuntimeError.NOT_SUPPORTED_ERR);return o[n].apply(this,i)},XMLHttpRequest:function(){function r(t){var r="----moxieboundary"+(new Date).getTime(),i="--",a="\r\n",f="",l,c="";if(!u.can("send_binary_string"))throw new s.RuntimeError(s.RuntimeError.NOT_SUPPORTED_ERR);return e.setRequestHeader("Content-Type","multipart/form-data; boundary="+r),n.typeOf(t)==="object"&&n.each(t,function(e,t){e instanceof n.Blob?(l=e.getSource(),c+=i+r+a+'Content-Disposition: form-data; name="'+t+'"; filename="'+unescape(encodeURIComponent(e.name||"blob"))+'"'+a+"Content-Type: "+e.type+a+a+l+a):c+=i+r+a+'Content-Disposition: form-data; name="'+t+'"'+a+a+unescape(encodeURIComponent(e))+a}),c+=i+r+i+a,c}var e,t;n.extend(this,{send:function(i,s){var u=this,a=!1,f;e=new XMLHttpRequest,t=i.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),e.open(i.method,i.url,i.async,i.user,i.password),n.isEmptyObj(i.headers)||n.each(i.headers,function(t,n){e.setRequestHeader(n,t)}),s instanceof n.Blob?s.isDetached()?(s=r({Filedata:s}),a=!0):s=s.getSource():s instanceof n.FormData&&(s._blob&&s._fields[s._blob].isDetached()?(s=r(s._fields),a=!0):(f=new FormData,n.each(s._fields,function(e,t){e instanceof n.Blob?f.append(t,e.getSource()):f.append(t,e)}),s=f)),""!==i.responseType&&("json"===i.responseType&&!n.ua.can("receive_response_type","json")?e.responseType="text":e.responseType=i.responseType),function(){function r(e){u.trigger(e)}function i(e){u.trigger({type:"UploadProgress",loaded:e.loaded,total:e.total})}function s(){n.each(t,function(t){e.removeEventListener(t,r)}),e.removeEventListener("loadend",s),e.upload&&e.upload.removeEventListener("progress",i)}var t=["loadstart","progress","abort","error","load","timeout"];n.each(t,function(t){e.addEventListener(t,r)}),e.upload&&e.upload.addEventListener("progress",i),e.addEventListener("loadend",s)}(),a?e.sendAsBinary?e.sendAsBinary(s):function(){var t=new Uint8Array(s.length);for(var n=0;n<s.length;n++)t[n]=s.charCodeAt(n)&255;e.send(t.buffer)}():e.send(s)},getStatus:function(){try{if(e)return e.status}catch(t){}},getResponse:function(r){try{if(e){if("blob"===r){var i=new n.File(u.uid,e.response);return i.name=t,i}return"json"===r&&!n.ua.can("receive_response_type","json")?n.JSON.parse(e.response):e.response}}catch(s){}},abort:function(){e&&e.abort()}})},Image:function(){function d(e){return n.atob(e.substring(e.indexOf("base64,")+7))}function v(e){var t=this,r;w.call(this),a=new Image,a.onerror=function(){throw w.call(this),new s.ImageError(s.ImageError.WRONG_FORMAT)},a.onload=function(){c=e,t.trigger("load",i.getInfo())},a.src="data:"+(h.type||"")+";base64,"+n.btoa(e)}function m(e){var t=this;a=new Image,a.onerror=function(){throw w.call(this),new s.ImageError(s.ImageError.WRONG_FORMAT)},a.onload=function(){t.trigger("load",i.getInfo())},a.src=e}function g(t,n){var r;if(!e.FileReader)return n(t.getAsBinary());r=new FileReader,r.onload=function(){n(r.result)},r.readAsBinaryString(t)}function y(t,n){var r;if(!e.FileReader)return n(t.getAsDataURL());r=new FileReader,r.onload=function(){n(r.result)},r.readAsDataURL(t)}function b(e,n,r){var i,s,o,u,f,c,h;o=r?Math.max:Math.min,s=o(e/this.width,n/this.height),c=Math.round(this.width*s),h=Math.round(this.height*s);if(s>1){this.trigger("Resize");return}l||(l=t.createElement("canvas")),i=l.getContext("2d"),r?(l.width=e,l.height=n):(l.width=c,l.height=h),u=c>l.width?Math.round((c-l.width)/2):0,f=h>l.height?Math.round((h-l.height)/2):0,i.clearRect(0,0,l.width,l.height),i.drawImage(a,-u,-f,c,h),p=!0,this.trigger("Resize",{width:r?e:c,height:r?n:h})}function w(){f&&(f.purge(),f=null),c=a=l=null,p=!1}var i=this,a,f,l,c,h,p=!1;n.extend(i,{loadFromBlob:function(e,t){var n=this;if(!u.can("access_binary"))throw new s.RuntimeError(s.RuntimeError.NOT_SUPPORTED_ERR);if(e.isDetached()){h={name:e.name,size:e.size,type:e.type},v.call(this,e.getSource());return}h=e.getSource(),t?g(h,function(e){v.call(n,e)}):y(h,function(e){m.call(n,e)})},loadFromImage:function(e,t){h={name:e.name,size:e.size,type:e.type},t?v.call(this,e.getAsBinaryString()):(a=e.getAsImage(),this.trigger("load",i.getInfo()))},getInfo:function(){var e={width:a&&a.width||0,height:a&&a.height||0,type:h&&(h.type||h.name&&n.mimes[h.name.replace(/^.+\.([^\.]+)$/,"$1").toLowerCase()])||"",size:c&&c.length||h.size||0,name:h&&h.name||"",meta:{}};return u.can("access_image_binary")&&c&&(f&&f.purge(),f=new n.ImageInfo(c),n.extend(e,f)),e},resize:function(){if(!a)throw new s.DOMException(s.DOMException.INVALID_STATE_ERR);b.apply(this,arguments)},getAsImage:function(){if(!a)throw new s.DOMException(s.DOMException.INVALID_STATE_ERR);return a.id=this.uid+"_img",a},getAsCanvas:function(){if(!l)throw new s.DOMException(s.DOMException.INVALID_STATE_ERR);return l.id=this.uid+"_canvas",l},getAsBlob:function(e,t){var r;e!==this.type&&b.call(this,this.width,this.height,!1);if(!p&&!!~n.inArray(n.typeOf(h),["blob","file"]))r=new n.Blob(u.uid,h);else{var s=i.getAsBinaryString.call(this,e,t);r=new n.Blob(null,{type:e,size:s.length}),r.detach(s)}return r},getAsDataURL:function(e,t){if(!p)return a.src;if("image/jpeg"!==e)return l.toDataURL("image/png");try{return l.toDataURL("image/jpeg",t/100)}catch(n){return l.toDataURL("image/jpeg")}},getAsBinaryString:function(e,t){if(!p)return c||(c=d(i.getAsDataURL(e,t))),c;if("image/jpeg"!==e)c=d(i.getAsDataURL(e,t));else{var n;t||(t=90);try{n=l.toDataURL("image/jpeg",t/100)}catch(r){n=l.toDataURL("image/jpeg")}c=d(n),f&&(f.meta&&f.meta.exif&&f.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),c=f.writeHeaders(c))}return p=!1,c},destroy:function(){w.call(this),delete r[this.uid]}})}}}()}return r.can=function(){function i(){var e=[].slice.call(arguments);return e.unshift(r),n.Runtime.can.apply(this,e)}var r=n.extend({},n.Runtime.caps,{access_binary:!!(e.FileReader||e.File&&File.getAsDataURL),access_image_binary:function(){return i("access_binary")&&!!n.ImageInfo},display_media:n.ua.can("create_canvas")||n.ua.can("use_data_uri_over32kb"),drag_and_drop:function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e}(),receive_response_type:function(e){return e==="json"?!0:n.ua.can("receive_response_type",e)},report_upload_progress:function(){return!!e.XMLHttpRequest&&!!(new XMLHttpRequest).upload},resize_image:function(){return i("access_binary")&&n.ua.can("create_canvas")},select_multiple:n.ua.browser!=="Safari"||n.ua.os!=="Windows",send_binary_string:!!e.XMLHttpRequest&&!!((new XMLHttpRequest).sendAsBinary||e.Uint8Array&&e.ArrayBuffer),send_custom_headers:!!e.XMLHttpRequest,send_multipart:function(){return!!(e.XMLHttpRequest&&(new XMLHttpRequest).upload&&e.FormData)||i("send_binary_string")},slice_blob:!!e.File&&!!(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice),stream_upload:function(){return i("slice_blob")&&i("send_multipart")},summon_file_dialog:function(){return n.ua.browser==="Firefox"&&n.ua.version>=4||n.ua.browser==="Opera"&&n.ua.version>=12||!!~n.inArray(n.ua.browser,["Chrome","Safari"])}(),upload_filesize:!0});return i}(),r}())}(window,document,mOxie),function(e,t,n,r){var i="html4",s=n.Exceptions;n.Runtime.addConstructor(i,function(){function r(r){var u=this,a;defaults={},r=typeof r=="object"?n.extend(defaults,r):defaults,n.Runtime.getConstructor("html5")?(n.Runtime.getConstructor("html5").apply(this,[r,arguments[1]||i]),a=this.getShim()):(n.Runtime.apply(this,[r,arguments[1]||i]),a={}),n.extend(this,{init:function(){u.trigger("Init")},FileInput:function(){function a(){var f=this,l,c,h,p,d,v;v=n.guid("uid_"),l=u.getShimContainer(),e&&(h=n(e+"_form"),h&&n.extend(h.style,{top:"100%"})),p=t.createElement("form"),p.setAttribute("id",v+"_form"),p.setAttribute("method","post"),p.setAttribute("enctype","multipart/form-data"),p.setAttribute("encoding","multipart/form-data"),n.extend(p.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),d=t.createElement("input"),d.setAttribute("id",v),d.setAttribute("type","file"),d.setAttribute("name","Filedata"),d.setAttribute("accept",i.join(",")),n.extend(d.style,{fontSize:"999px",opacity:0}),p.appendChild(d),l.appendChild(p),n.extend(d.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),n.ua.browser==="IE"&&n.ua.version<10&&plupload.extend(d.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),d.onchange=function(){var e;if(!this.value)return;this.files?e=this.files[0]:e={name:this.value},r=[e],this.onchange=function(){},a.call(f),f.bind("change",function(){var e=n(v),t=n(v+"_form"),r;f.files.length&&e&&t&&(r=f.files[0],e.setAttribute("id",r.uid),t.setAttribute("id",r.uid+"_form"),t.setAttribute("target",r.uid+"_iframe")),e=t=null},998),d=p=null,f.trigger("change")},u.can("summon_file_dialog")&&(c=n(s.browse_button),n.removeEvent(c,"click",f.uid),n.addEvent(c,"click",function(e){d&&!d.disabled&&d.click(),e.preventDefault()},f.uid)),e=v,l=h=c=null}var e,r=[],i=[],s;return{init:function(e){var t=this,r,f,l;s=e,i=e.accept.mimes||n.extList2mimes(e.accept),l=u.getShimContainer(),function(){var r,i,s;r=n(e.browse_button),u.can("summon_file_dialog")&&(n.getStyle(r,"position")==="static"&&(r.style.position="relative"),i=parseInt(n.getStyle(r,"z-index"),10)||1,r.style.zIndex=i,l.style.zIndex=i-1),s=u.can("summon_file_dialog")?r:l,n.addEvent(s,"mouseover",function(){t.trigger("mouseenter")},t.uid),n.addEvent(s,"mouseout",function(){t.trigger("mouseleave")},t.uid),n.addEvent(s,"mousedown",function(){t.trigger("mousedown")},t.uid),n.addEvent(n(e.container),"mouseup",function(){t.trigger("mouseup")},t.uid)}(),a.call(this),browsebutton=l=null},getFiles:function(){return r},disable:function(t){var r;if(r=n(e))r.disabled=!!t}}}()}),n.extend(a,{XMLHttpRequest:function(){function f(e){var t=this,r,i,s,u,f=!1;if(!a)return;r=a.id.replace(/_iframe$/,""),i=n(r+"_form");if(i){s=i.getElementsByTagName("input"),u=s.length;while(u--)switch(s[u].getAttribute("type")){case"hidden":s[u].parentNode.removeChild(s[u]);break;case"file":f=!0}s=[],f||i.parentNode.removeChild(i),i=null}setTimeout(function(){n.removeEvent(a,"load",t.uid),a.parentNode&&a.parentNode.removeChild(a),a=null,e()},1)}var r,i,a;n.extend(this,{send:function(l,c){function g(){var s=u.getShimContainer()||t.body,l=t.createElement("div");l.innerHTML='<iframe id="'+p+'_iframe" name="'+p+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',a=l.firstChild,s.appendChild(a),n.addEvent(a,"load",function(t){var s;try{s=a.contentWindow.document||a.contentDocument||e.frames[a.id].document;if(/^4\d{2}\s/.test(s.title)&&s.getElementsByTagName("address").length){r=s.title.replace(/^(\d+).*$/,"$1"),h.trigger("error");return}r=200}catch(u){r=404,h.trigger("error");return}i=n.trim(s.body.innerHTML),f.call(this,function(){h.trigger({type:"uploadprogress",loaded:m&&m.size||1025,total:m&&m.size||1025}),h.trigger("load")})},h.uid)}var h=this,p,d,v,m;r=i=null;if(c instanceof n.FormData){if(c._blob){m=c._fields[c._blob],p=m.uid,v=n(p),d=n(p+"_form");if(!d)throw new s.DOMException(s.DOMException.NOT_FOUND_ERR)}else p=n.guid("uid_"),d=t.createElement("form"),d.setAttribute("id",p+"_form"),d.setAttribute("method","post"),d.setAttribute("enctype","multipart/form-data"),d.setAttribute("encoding","multipart/form-data"),d.setAttribute("target",p+"_iframe");n.each(c._fields,function(e,r){if(e instanceof n.Blob)v&&v.setAttribute("name",r);else{var i=t.createElement("input");n.extend(i,{type:"hidden",name:r,value:e}),d.appendChild(i)}}),d.setAttribute("action",l.url),g(),d.submit(),h.trigger("loadstart"),temp=container=d=null}},getStatus:function(){return r},getResponse:function(e){if("json"===e)return n.JSON.parse(i.replace(/^\s*<pre>/,"").replace(/<\/pre>\s*$/,""));if("document"!==e)return i},abort:function(e){var t=this;a&&a.contentWindow&&(a.contentWindow.stop?a.contentWindow.stop():a.contentWindow.document.execCommand?a.contentWindow.document.execCommand("Stop"):a.src="about:blank"),f.call(this,function(){t.dispatchEvent("abort")})}})}})}return r.can=function(){function r(){var e=[].slice.call(arguments);return e.unshift(t),n.Runtime.can.apply(this,e)}var t=n.extend({},n.Runtime.caps,{access_binary:!!(e.FileReader||e.File&&File.getAsDataURL),access_image_binary:!1,display_media:n.ua.can("create_canvas")||n.ua.can("use_data_uri_over32kb"),drag_and_drop:!1,receive_response_type:function(e){return!!~n.inArray(n.ua.browser,["json","text","document",""])},resize_image:function(){return r("access_binary")&&n.ua.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:!0,summon_file_dialog:function(){return n.ua.browser==="Firefox"&&n.ua.version>=4||n.ua.browser==="Opera"&&n.ua.version>=12||!!~n.inArray(n.ua.browser,["Chrome","Safari"])}(),upload_filesize:!0});return r}(),r}())}(window,document,mOxie),function(e,t,n,r){var i="flash",s=n.Exceptions;n.Runtime.addConstructor(i,function(){function e(e){function f(){var e;try{e=navigator.plugins["Shockwave Flash"],e=e.description}catch(t){try{e=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(n){e="0.0"}}return e=e.match(/\d+/g),parseFloat(e[0]+"."+e[1])}function l(e){l.counter===r&&(l.counter=0);if(l.counter++>e)throw u.destroy(),new s.RuntimeError(s.RuntimeError.NOT_INIT_ERR);u.initialized||setTimeout(function(){l.call(u,e)},1)}var u=this,a;defaults={swf_url:"js/Moxie.swf"},u.options=e=n.extend({},defaults,e),n.Runtime.apply(this,[e,arguments[1]||i]),n.extend(this,{init:function(){var r,i,a;if(f()<10)throw u.destroy(),new s.RuntimeError(s.RuntimeError.NOT_INIT_ERR);a=u.getShimContainer(),n.extend(a.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),r='<object id="'+u.uid+'" type="application/x-shockwave-flash" data="'+e.swf_url+'" ',n.ua.browser==="IE"&&(r+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),r+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+e.swf_url+'" />'+'<param name="flashvars" value="uid='+escape(u.uid)+'" />'+'<param name="wmode" value="transparent" />'+'<param name="allowscriptaccess" value="always" />'+"</object>",n.ua.browser==="IE"?(i=t.createElement("div"),a.appendChild(i),i.outerHTML=r,i=a=null):a.innerHTML=r,l(5e3)}}),n.extend(this,function(){function e(e,t,r){switch(t){case"readAsText":case"readAsBinaryString":return n.atob(e);case"readAsDataURL":return e}return null}return{Transporter:{getAsBlob:function(e){var t=u.shimExec.call(this,"Transporter","getAsBlob",e);return t?new n.Blob(u.uid,t):null}},Blob:{slice:function(e,t,r,i){return t<0?t=Math.max(e.size+t,0):t>0&&(t=Math.min(t,e.size)),r<0?r=Math.max(e.size+r,0):r>0&&(r=Math.min(r,e.size)),e=u.shimExec.call(this,"BlobSlicer","slice",e.id,t,r,i||""),e&&(e=new n.Blob(u.uid,e)),e}},FileReader:{read:function(t,n){var r=this;return t==="readAsDataURL"&&(r.result="data:"+(n.type||"")+";base64,"),r.bind("Progress",function(n,i){i&&(r.result+=e(i,t))},999),u.shimExec.call(this,"FileReader","readAsBase64",n.getSource().id)}},FileReaderSync:{read:function(t,n){var r;return r=u.shimExec.call(this,"FileReaderSync","readAsBase64",n.getSource().id),r?(t==="readAsDataURL"&&(r="data:"+(n.type||"")+";base64,"+r),e(r,t,n.type)):null}},XMLHttpRequest:{send:function(e,t){function i(){u.shimExec.call(r,"XMLHttpRequest","send",e,t)}function s(e,n){u.shimExec.call(r,"XMLHttpRequest","appendBlob",e,n.getSource().id),t=null,i()}function a(e,t){var r=new n.Transporter;r.bind("TransportingComplete",function(){s(e,this.result)}),r.transport(t.getSource(),t.type,{ruid:u.uid})}var r=this;n.isEmptyObj(e.headers)||n.each(_headers,function(e,t){u.shimExec.call(r,"XMLHttpRequest","setRequestHeader",name,e.toString())});if(t instanceof n.FormData){n.each(t._fields,function(e,t){e instanceof n.Blob||u.shimExec.call(r,"XMLHttpRequest","append",t,e.toString())});if(!t._blob)t=null,i();else{var f=t._fields[t._blob];f.isDetached()?a(t._blob,f):s(t._blob,f)}}else t instanceof n.Blob?t=t.uid:i()},getResponse:function(e){var t,r;t=u.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob");if(t){t=new n.File(u.uid,t);if("blob"===e)return t;if(!!~n.inArray(e,["","text"])){var i=new n.FileReaderSync;return i.readAsText(t)}if("arraybuffer"!==e&&"json"===e){var i=new n.FileReaderSync;return this.bind("Exception",function(e,t){console.info(t)}),n.JSON.parse(i.readAsText(t))}}return null},abort:function(e){u.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort"),!e}},Image:{loadFromBlob:function(e){function r(e){u.shimExec.call(t,"Image","loadFromBlob",e.id)}var t=this;if(e.isDetached()){var i=new n.Transporter;i.bind("TransportingComplete",function(){r(i.result.getSource())}),i.transport(e.getSource(),e.type,u.uid)}else r(e.getSource())},loadFromImage:function(e,t){return u.shimExec.call(this,"Image","loadFromImage",e.uid)},getAsBlob:function(e,t){var r=u.shimExec.call(this,"Image","getAsBlob",e,t);return r?new n.Blob(u.uid,r):null},getAsDataURL:function(e,t){var r,i=u.Image.getAsBlob.apply(this,arguments);return i?(r=new n.FileReaderSync,r.readAsDataURL(i)):null}}}}())}return e.can=function(){function r(){var e=[].slice.call(arguments);return e.unshift(t),n.Runtime.can.apply(this,e)}var e=function(){var e=this.options.required_caps;return!n.isEmptyObj(e)&&(e.access_binary||e.send_custom_headers)},t=n.extend({},n.Runtime.caps,{access_binary:!0,access_image_binary:!0,display_media:!0,drag_and_drop:!1,receive_response_type:!0,report_upload_progress:!0,resize_image:!0,return_response_headers:!1,select_multiple:!0,send_binary_string:!0,send_custom_headers:!0,send_multipart:!0,slice_blob:!0,stream_upload:function(t){return!!t&!e.call(this)},summon_file_dialog:!1,upload_filesize:function(t){var r=e.call(this)?2097152:-1;return!~r||n.parseSizeStr(t)<=r?!0:!1},use_http_method:function(e){n.typeOf(e)!=="array"&&(e=[e]);for(var t in e)if(!~n.inArray(e[t].toUpperCase(),["GET","POST"]))return!1;return!0}});return r}(),e}())}(window,document,mOxie),function(e,t,n,r){var s="silverlight",o=n.Exceptions;n.Runtime.addConstructor(s,function(){function e(e){function a(e){var t=!1,n=null,r=null,i,s,o,u,a,f=0;try{try{r=new ActiveXObject("AgControl.AgControl"),r.IsVersionSupported(e)&&(t=!0),r=null}catch(l){var c=navigator.plugins["Silverlight Plug-In"];if(c){i=c.description,i==="1.0.30226.2"&&(i="2.0.30226.2"),s=i.split(".");while(s.length>3)s.pop();while(s.length<4)s.push(0);o=e.split(".");while(o.length>4)o.pop();do u=parseInt(o[f],10),a=parseInt(s[f],10),f++;while(f<o.length&&u===a);u<=a&&!isNaN(u)&&(t=!0)}}}catch(h){t=!1}return t}function f(e){f.counter===r&&(f.counter=0);if(f.counter++>e)throw t.destroy(),new o.RuntimeError(o.RuntimeError.NOT_INIT_ERR);t.initialized||setTimeout(function(){f.call(t,e)},1)}var t=this,u;defaults={xap_url:"js/Moxie.xap"},t.options=e=n.extend({},defaults,e);if(!n.Runtime.getConstructor("flash"))throw new o.RuntimeError(o.RuntimeError.NOT_INIT_ERR);n.Runtime.getConstructor("flash").apply(this,[e,arguments[1]||s]),n.extend(this,{getShim:function(){return n(this.uid).content.Moxie},init:function(){var r,i,s;if(!a("2.0.31005.0")||n.ua.browser==="Opera")throw t.destroy(),new o.RuntimeError(o.RuntimeError.NOT_INIT_ERR);s=t.getShimContainer(),s.innerHTML='<object id="'+t.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;">'+'<param name="source" value="'+e.xap_url+'"/>'+'<param name="background" value="Transparent"/>'+'<param name="windowless" value="true"/>'+'<param name="enablehtmlaccess" value="true"/>'+'<param name="initParams" value="uid='+t.uid+'"/>'+"</object>",f(1e4)},FileInput:{init:function(e){function n(e){var t="";for(i=0;i<e.length;i++)t+=(t!=""?"|":"")+e[i].title+" | *."+e[i].extensions.replace(/,/g,";*.");return t}return t.shimExec.call(this,"FileInput","init",n(e.accept),e.name,e.multiple)}}})}return e.can=function(){function t(){var t=[].slice.call(arguments);return t.unshift(e),n.Runtime.can.apply(this,t)}var e=n.extend({},n.Runtime.caps,{access_binary:!0,access_image_binary:!0,display_media:!0,drag_and_drop:!1,receive_response_type:function(e){return!~n.inArray(e,["blob"])},report_upload_progress:!0,resize_image:!0,return_response_headers:!1,select_multiple:!0,send_binary_string:!0,send_custom_headers:!0,send_multipart:!0,slice_blob:!0,stream_upload:!0,summon_file_dialog:!1,upload_filesize:!0,use_http_method:function(e){n.typeOf(e)!=="array"&&(e=[e]);for(var t in e)if(!~n.inArray(e[t].toUpperCase(),["GET","POST"]))return!1;return!0}});return t}(),e}())}(window,document,mOxie);
/**
 * Plupload - multi-runtime File Uploader
 * v2.0a
 *
 * Copyright 2012, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 *
 * Date: 2012-11-30
 */
;(function(e,t,n){var r=e.setTimeout,s={VERSION:"2.0a",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:t.mimes,ua:t.ua,typeOf:t.typeOf,extend:t.extend,guid:t.guid,each:t.each,getPos:t.getPos,getSize:t.getSize,xmlEncode:t.xmlEncode,toArray:t.toArray,inArray:t.inArray,addI18n:t.addI18n,translate:t.translate,isEmptyObj:t.isEmptyObj,hasClass:t.hasClass,addClass:t.addClass,removeClass:t.removeClass,getStyle:t.getStyle,addEvent:t.addEvent,removeEvent:t.removeEvent,removeAllEvents:t.removeAllEvents,cleanName:function(e){var t,n;n=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(t=0;t<n.length;t+=2)e=e.replace(n[t],n[t+1]);return e=e.replace(/\s+/g,"_"),e=e.replace(/[^a-z0-9_\-\.]+/gi,""),e},buildUrl:function(e,t){var n="";return s.each(t,function(e,t){n+=(n?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(e)}),n&&(e+=(e.indexOf("?")>0?"&":"?")+n),e},formatSize:function(e){return e===n||/\D/.test(e)?s.translate("N/A"):e>1073741824?Math.round(e/1073741824,1)+" GB":e>1048576?Math.round(e/1048576,1)+" MB":e>1024?Math.round(e/1024,1)+" KB":e+" b"},parseSize:t.parseSizeStr};s.Uploader=function(e){function y(){var e,t=0,n;if(this.state==s.STARTED){for(n=0;n<u.length;n++)!e&&u[n].status==s.QUEUED?(e=u[n],this.trigger("BeforeUpload",e)&&(e.status=s.UPLOADING,this.trigger("UploadFile",e))):t++;t==u.length&&(this.state!==s.STOPPED&&(this.state=s.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",u))}}function b(e){e.percent=e.size>0?Math.ceil(e.loaded/e.size*100):100,w()}function w(){var e,t;p.reset();for(e=0;e<u.length;e++)t=u[e],t.size!==n?(p.size+=t.origSize,p.loaded+=t.loaded*t.origSize/t.size):p.size=n,t.status==s.DONE?p.uploaded++:t.status==s.FAILED?p.failed++:p.queued++;p.size===n?p.percent=u.length>0?Math.ceil(p.uploaded/u.length*100):0:(p.bytesPerSec=Math.ceil(p.loaded/((+(new Date)-h||1)/1e3)),p.percent=p.size>0?Math.ceil(p.loaded/p.size*100):0)}function E(e){var t,n=[];for(t=0;t<e.length;t++)n.push(new s.File(e[t]));n.length&&this.trigger("FilesAdded",n)}function S(){var n=this,r=0;t.inSeries([function(i){if(e.browse_button)try{v=new t.FileInput({accept:e.filters,runtime_order:e.runtimes,name:e.file_data_name,multiple:e.multi_selection,container:e.container,browse_button:e.browse_button,required_caps:l,swf_url:e.flash_swf_url,xap_url:e.silverlight_xap_url}),v.onready=function(){var e=t.Runtime.getInfo(this.ruid);t.extend(n.features,{chunks:e.can("slice_blob"),multipart:e.can("send_multipart"),multi_selection:e.can("select_multiple")}),r++,i()},v.onerror=function(){i()},v.onchange=function(){E.call(n,this.files)},v.bind("mouseenter mouseleave mousedown mouseup",function(n){if(!d){var r=t(e.browse_button);r&&(e.browse_button_hover&&("mouseenter"===n.type?t.addClass(r,e.browse_button_hover):"mouseleave"===n.type&&t.removeClass(r,e.browse_button_hover)),e.browse_button_active&&("mousedown"===n.type?t.addClass(r,e.browse_button_active):"mouseup"===n.type&&t.removeClass(r,e.browse_button_active)),r=null)}}),v.init()}catch(s){i()}else i()},function(i){if(e.drop_element)try{m=new t.FileDrop({drop_zone:e.drop_element,accept:e.filters,runtime_order:e.runtimes,required_caps:l,swf_url:e.flash_swf_url,xap_url:e.silverlight_xap_url}),m.onerror=function(){i()},m.onready=function(){var e=t.Runtime.getInfo(this.ruid);n.features.dragdrop=e.can("drag_and_drop"),r++,i()},m.ondrop=function(){E.call(n,this.files)},m.init()}catch(s){i()}else i()}],function(t){r?(n.trigger("PostInit"),typeof e.init=="function"?e.init(n):s.each(e.init,function(e,t){n.bind(t,e)})):n.trigger("Error",{code:s.INIT_ERROR,message:s.translate("Init error.")})})}function x(e,n){if(e.ruid){var r=t.Runtime.getInfo(e.ruid);if(r)return r.can(n)}return!1}function T(e,n,r){var i=new t.Image;try{i.onload=function(){i.resize(n.width,n.height,n.crop)},i.onresize=function(){r(i.getAsBlob(e.type,n.quality))},i.onerror=function(){r(e)},i.load(e)}catch(s){r(e)}}var u=[],a={},f=[],l={},c={},h,p,d=!1,v,m,g;p=new s.QueueProgress,e=s.extend({chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",filters:[],urlstream_upload:!1},e),c={chunks:"slice_blob",resize:"send_binary_string",jpgresize:"send_binary_string",pngresize:"send_binary_string",multipart:"send_multipart",progress:"report_upload_progress",multi_selection:"select_multiple",canSendBinary:"send_binary"},typeof e.required_features=="string"&&(f=e.required_features.split(/\s*,\s*/)),f.length&&s.each(f,function(e){c[e]?l[c[e]]=!0:l[e]=!0}),s.extend(this,{id:s.guid(),state:s.STOPPED,features:{},files:u,settings:e,total:p,init:function(){var a=this;e.chunk_size=s.parseSize(e.chunk_size),e.max_file_size=s.parseSize(e.max_file_size),e.drop_element=t(e.drop_element),typeof e.preinit=="function"?e.preinit(a):s.each(e.preinit,function(e,t){a.bind(t,e)}),a.bind("FilesAdded",function(t,i){var o,f,l=0,c,h=e.filters;h&&h.length&&(c=[],s.each(h,function(e){s.each(e.extensions.split(/,/),function(e){/^\s*\*\s*$/.test(e)?c.push("\\.*"):c.push("\\."+e.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),c=new RegExp(c.join("|")+"$","i"));for(o=0;o<i.length;o++){f=i[o],f.loaded=0,f.percent=0,f.status=s.QUEUED;if(c&&!c.test(f.name)){t.trigger("Error",{code:s.FILE_EXTENSION_ERROR,message:s.translate("File extension error."),file:f});continue}if(f.size!==n&&f.size>e.max_file_size){t.trigger("Error",{code:s.FILE_SIZE_ERROR,message:s.translate("File size error."),file:f});continue}u.push(f),l++}if(!l)return!1;r(function(){a.trigger("QueueChanged"),a.refresh()},1)}),a.bind("CancelUpload",function(){g&&g.abort()}),e.unique_names&&a.bind("UploadFile",function(e,t){var n=t.name.match(/\.([^.]+)$/),r="part";n&&(r=n[1]),t.target_name=t.id+"."+r}),a.bind("UploadFile",function(n,i){function h(){var p,d,v=0,m,y,b,w;if(i.status==s.DONE||i.status==s.FAILED||n.state==s.STOPPED)return;a=i.loaded,y={name:i.target_name||i.name},e.chunk_size&&c.chunks&&u.size>e.chunk_size?(b=e.chunk_size,v=Math.floor(i.loaded/b),m=Math.ceil(u.size/b),w=Math.min(b,u.size-v*b),p=u.slice(v*b,v*b+w),y.chunk=v,y.chunks=m):(w=u.size,p=u),g=new t.XMLHttpRequest,g.upload&&(g.upload.onprogress=function(e){i.loaded=Math.min(i.size,a+e.loaded),n.trigger("UploadProgress",i)}),g.onload=function(){m?(p.isDetached()&&p.destroy(),a+=w,i.loaded=Math.min(i.size,(v+1)*b),chunkArgs={chunk:v,chunks:m,response:g.responseText,status:g.status},n.trigger("ChunkUploaded",i,chunkArgs)):i.loaded=i.size,n.trigger("UploadProgress",i),p=d=null,!m||v+1>=m?(i.status=s.DONE,n.trigger("FileUploaded",i,{response:g.responseText,status:g.status})):r(h,1)},g.onerror=function(){n.trigger("Error",{code:s.HTTP_ERROR,message:s.translate("HTTP Error."),file:i,status:g.status})},g.onloadend=function(){this.unbindAll()},n.settings.multipart&&c.multipart?(y.name=i.target_name||i.name,g.open("post",f,!0),s.each(n.settings.headers,function(e,t){g.setRequestHeader(t,e)}),d=new t.FormData,s.each(s.extend(y,n.settings.multipart_params),function(e,t){d.append(t,e)}),d.append(n.settings.file_data_name,p),g.send(d,{runtime_order:n.settings.runtimes,required_caps:l,swf_url:n.settings.flash_swf_url,xap_url:n.settings.silverlight_xap_url})):(f=s.buildUrl(n.settings.url,s.extend(y,n.settings.multipart_params)),g.open("post",f,!0),g.setRequestHeader("Content-Type","application/octet-stream"),s.each(n.settings.headers,function(e,t){g.setRequestHeader(t,e)}),g.send(p,{runtime_order:n.settings.runtimes,required_caps:l,swf_url:n.settings.flash_swf_url,xap_url:n.settings.silverlight_xap_url}))}var u,a,f=n.settings.url,c=n.features;u=i.getSource(),!t.isEmptyObj(n.settings.resize)&&x(u,"send_binary_string")&&!!~t.inArray(u.type,["image/jpeg","image/png"])?T.call(this,u,n.settings.resize,function(e){u=e,i.size=e.size,h()}):h()}),a.bind("UploadProgress",function(e,t){b(t)}),a.bind("StateChanged",function(e){if(e.state==s.STARTED)h=+(new Date);else if(e.state==s.STOPPED)for(i=e.files.length-1;i>=0;i--)e.files[i].status==s.UPLOADING&&(e.files[i].status=s.QUEUED,w())}),a.bind("QueueChanged",w),a.bind("Error",function(e,t){t.file&&(t.file.status=s.FAILED,w(),e.state==s.STARTED&&r(function(){y.call(a)},1))}),a.bind("FileUploaded",function(e,t){t.status=s.DONE,t.loaded=t.size,b(t),r(function(){y.call(a)},1)}),a.trigger("Init",{runtime:"Generic"}),S.call(this)},refresh:function(){v.trigger("Refresh"),this.trigger("Refresh")},start:function(){this.state!=s.STARTED&&(this.state=s.STARTED,this.trigger("StateChanged"),y.call(this))},stop:function(){this.state!=s.STOPPED&&(this.state=s.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){d=arguments[0]!==n?arguments[0]:!0,v&&v.disable(d),this.trigger("DisableBrowse",d)},getFile:function(e){var t;for(t=u.length-1;t>=0;t--)if(u[t].id===e)return u[t]},addFile:function(e){function u(e){var a=t.typeOf(e);if(e instanceof t.File||e instanceof t.Blob)r.push(e);else{if(a==="file"){i.push(function(r){var i=new t.RuntimeTarget;i.bind("RuntimeInit",function(n,i){u(new t.File(i.uid,e)),r()});try{i.connectRuntime({runtime_order:"html5"})}catch(a){n.trigger("Error",{code:s.FILE_EXTENSION_ERROR,message:s.translate("File extension error."),file:e}),r()}});return}a==="node"&&t.typeOf(e.files)==="filelist"?t.each(e.files,u):a==="array"&&t.each(e,u)}}var n=this,r=[],i=[];u(e),t.inSeries(i,function(){E.call(n,r)})},removeFile:function(e){var t;for(t=u.length-1;t>=0;t--)if(u[t].id===e.id)return this.splice(t,1)[0]},splice:function(e,t){var r;return r=u.splice(e===n?0:e,t===n?u.length:t),this.trigger("FilesRemoved",r),this.trigger("QueueChanged"),r},trigger:function(e){var t=a[e.toLowerCase()],n,r;if(t){r=Array.prototype.slice.call(arguments),r[0]=this;for(n=0;n<t.length;n++)if(t[n].func.apply(t[n].scope,r)===!1)return!1}return!0},hasEventListener:function(e){return!!a[e.toLowerCase()]},bind:function(e,t,n){var r;e=e.toLowerCase(),r=a[e]||[],r.push({func:t,scope:n||this}),a[e]=r},unbind:function(e){e=e.toLowerCase();var t=a[e],r,i=arguments[1];if(t){if(i!==n){for(r=t.length-1;r>=0;r--)if(t[r].func===i){t.splice(r,1);break}}else t=[];t.length||delete a[e]}},unbindAll:function(){var e=this;s.each(a,function(t,n){e.unbind(n)})},destroy:function(){this.stop(),this.trigger("Destroy"),this.unbindAll()}})},s.File=function(){function t(t){s.extend(this,{id:s.guid(),name:t.name||t.fileName,type:t.type||"",size:t.size||t.fileSize,origSize:t.size||t.fileSize,loaded:0,percent:0,status:0,getSource:function(){return e[this.id]?e[this.id]:null}}),e[this.id]=t}var e={};return t}(),s.QueueProgress=function(){var e=this;e.size=0,e.loaded=0,e.uploaded=0,e.failed=0,e.queued=0,e.percent=0,e.bytesPerSec=0,e.reset=function(){e.size=e.loaded=e.uploaded=e.failed=e.queued=e.percent=e.bytesPerSec=0}},e.plupload=s})(window,mOxie);